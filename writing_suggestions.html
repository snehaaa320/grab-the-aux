<!DOCTYPE html>
<html>

<head>

  <style type="text/css">

        #song_div {
            overflow: auto;
        }

        #song_table {
            width: 100%;
            padding: 20px;
        }

        th,
        td {
            /* padding: 15px; */
            text-align: left;
            border: 1px solid black;
        }

        #write_suggestion_div {
            width: 100%;
        }
    </style>


    <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase.js"></script>
    <script src="https://cdn.firebase.com/libs/firebaseui/3.4.1/firebaseui.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
    <post ref="foo"></post>

    <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.min.js" type="text/javascript"></script>
    <link href="reading_songs.css" type="text/css" rel="stylesheet">
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyDs1juHP3-F2AazMkfw-RotpRqo-4LhVWg",
            authDomain: "grabtheaux-47eb2.firebaseapp.com",
            databaseURL: "https://grabtheaux-47eb2.firebaseio.com",
            projectId: "grabtheaux-47eb2",
            storageBucket: "grabtheaux-47eb2.appspot.com",
            messagingSenderId: "23642747296"
        };
        firebase.initializeApp(config);

    </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Upvote/Downvote Functionality - Reddit-like Posting System VueJs</title>

</head>

<body>
  <div id="app">
  </div>

  <div id="song_div">
        <h2>This is songs in the queue right now</h2>
        <table id="song_table">
            <tr>
                <th>Queue Number </th>
                <th>Song Name</th>
                <th>Song Artists</th>
                <th> Votes </th>
            </tr>
        </table>
    </div>
    <script>
        firebase.database().ref("/").child('.info/connected').on('value', function(connectedSnap) {
            if (connectedSnap.val() === true) {
                console.log("Connected to Firebase");
                getValuesFromDB();
            } else {
                console.log("Not Connected to Firebase");
            }
        });

        function
        getValuesFromDB() {
            firebase.database().ref('Playlist/temp_playlist/Queue/').on('value', function(queue) {
                queue.forEach(function(song) {
                    printToTable(song.key, song.child('Artist').val());
                });
            }, function(error) {
                console.log("Error : " + error.code);
            });
        }

        function printToTable(song_name, song_artist) {
            table = document.getElementById('song_table');
            var new_row = table.insertRow(-1);
            var song_name_cell = new_row.insertCell(0);
            var song_artist_cell = new_row.insertCell(1);
            var upvotes= new_row.insertCell(2);
            song_name_cell.innerHTML = song_name;
            song_artist_cell.innerHTML = song_artist;
            upvotes.innerHTML='<object type="text/html" data="upvotes.html" > </object>';

        }

    </script>
    <div id="write_suggestion_div">
        <h2>Write a suggestion to play</h2>
        <form id="suggestions" method="get">
            <table style="width:100%;padding:20px;">
                <tr>
                    <td>Song Title : </td>
                    <td><input id= "song_name" type="text" name="song_name" placeholder="Song Title..."></td>
                </tr>
                <tr>
                    <td>Song Artist : </td>
                    <td><input id="song_artist" type="text" name="song_artist" placeholder="Song Artists..."></td>
                </tr>
            </table>
            <button type="submit" name="submit_suggestions" onclick="writeToDB();">Submit Suggestion</button>
        </form>

        <script type="text/javascript">

            function writeToDB() {
                var song_name = document.getElementById("song_name").value;
                window.location.href = 'upvotes.html' + '#' + song_name;

                var song_artist = document.getElementById("song_artist").value;
                firebase.database().ref('Playlist/temp_playlist/Queue/'+song_name).set({
                    Artist: song_artist,
                    Upvotes: 0
                });

            }

        </script>
    </div>
    <button id="externalButton">External Button</button>

</body>

</html>
